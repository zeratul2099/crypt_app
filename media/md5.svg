<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   width="200mm"
   height="110mm"
   id="svg2"
>
<script type="text/ecmascript" xlink:href="/content/smil.user.js" />
  <defs
     id="defs4">
       <svg width="30" height="30" id="bit" >
            <rect y="10" x="0.1" width="19.9" height="19.9" fill="white" stroke="black" />
            <polygon fill="white" stroke="black" 
                points="0.1 10, 10 0.1, 29.9 0.1, 20 10" />
            <polygon fill="white" stroke="black" 
                points="29.9 0.1, 29.9 20, 20 29.9, 20 10" />
            
       </svg>
       <svg width="30" height="30" id="a" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
        A
       </text>
       </svg>
       <svg width="30" height="30" id="b" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
        B
       </text>
       </svg>
       <svg width="30" height="30" id="c" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
        C
       </text>
       </svg>
       <svg width="30" height="30" id="d" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
        D
       </text>
       </svg>
       
       <svg width="30" height="30" id="m0" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='0' y='25' style="font-size:14px;" >
       m<tspan style="baseline-shift:sub;font-size:8px">0</tspan>
       </text>
       </svg>
       
       <svg width="30" height="30" id="m1" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='0' y='25' style="font-size:14px;" >
       m<tspan style="baseline-shift:sub;font-size:8px">1</tspan>
       </text>
       </svg>
       
       <svg width="30" height="30" id="mn" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='0' y='25' style="font-size:14px;" >
       m<tspan style="baseline-shift:sub;font-size:8px">n</tspan>
       </text>
       </svg>
       
       <svg width="30" height="30" id="k0" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
       k<tspan style="baseline-shift:sub;font-size:8px">0</tspan>
       </text>
       </svg>
       
       <svg width="30" height="30" id="k1" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
       k<tspan style="baseline-shift:sub;font-size:8px">1</tspan>
       </text>
       </svg>

       <svg width="30" height="30" id="kn" >
       <use xlink:href='#bit' x='0' y='0' />
       <text fill='black' x='5' y='25' style="font-size:18px;" >
       k<tspan style="baseline-shift:sub;font-size:8px">n</tspan>
       </text>
       </svg>
       <svg id='f' width="20" height="100">
        <rect x='0.5' width="19" height="99" rx="10" ry="10"
        fill="white" stroke="black" />
        <text fill='black' x='8' y='50'>
        F
        </text>
       </svg>
       <path id='arrow0' d='m 0 0 l 50 0 -4 -4 m 4 4 l -4 4' stroke='black' />
       <path id='arrow1' d='m 0 0 l 20 0 -4 -4 m 4 4 l -4 4' stroke='black' />
       <svg id='xor' width="30" height="30" >
       
       <use xlink:href="#bit" x='0' y='0' />
       <circle cx='15' cy='15' r='13' stroke='red' stroke-width='2' />
       <path d="M 15 2 l 0 26 M 2 15 l 26 0" stroke='red' stroke-width='2' />
        </svg>
        
        <svg id='add' width="30" height="30" >
       
       <use xlink:href="#bit" x='0' y='0' />
       <rect x='2' y='12' width='16' height='16' stroke='red' stroke-width='2' />
       <path d="M 10 12 l 0 16 M 2 20 l 16 0" stroke='red' stroke-width='2' />
        </svg>
        <svg id='shift' width="30" height="30" >
        <use xlink:href="#bit" x='0' y='0' />
        <path d="M 10 12 l -10 5 10 5 m 10 -10 l -10 5 10 5 m 10 -10 l -10 5 10 5" stroke='red' stroke-width='2' />
        </svg>
  </defs>

  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>

    <g
       
       style="fill:none;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:round;stroke-opacity:1;font-family:'sans';"
       id="g2383 " transform="scale(0.9)"
       >
<rect x='0' y='0' width='800' height='500' fill='white' />
<svg id='f' width="20" height="100" x='200' y='100' >
        <rect x='0.5' width="19" height="99" rx="10" ry="10"
        fill="white" stroke="black" >
        <animateColor attributeName="fill" id='f_ani' begin='b02.end' dur='1' from='#ffffff' to='#ff0000' />
        <animateColor attributeName="fill" id='f_ani2' begin='f_ani.end' dur='1' from='#ff0000' to='#ffffff' fill='freeze' />
        </rect>
        <text fill='black' x='5' y='50' opacity='0' >
        F
        <animate attributeName='opacity' from='1' to='1' begin='round1.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round2.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round3.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round4.click' dur='1' fill='freeze' />
        </text>
        <text fill='black' x='5' y='50' opacity='0' >
        G
        <animate attributeName='opacity' from='0' to='0' begin='round1.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='1' to='1' begin='round2.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round3.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round4.click' dur='1' fill='freeze' />
        </text>
        <text fill='black' x='5' y='50' opacity='0' >
        H
        <animate attributeName='opacity' from='0' to='0' begin='round1.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round2.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='1' to='1' begin='round3.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round4.click' dur='1' fill='freeze' />
        </text>
        <text fill='black' x='5' y='50' opacity='0' >
        I
        <animate attributeName='opacity' from='0' to='0' begin='round1.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round2.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='0' to='0' begin='round3.click' dur='1' fill='freeze' />
        <animate attributeName='opacity' from='1' to='1' begin='round4.click' dur='1' fill='freeze' />
        </text>
</svg>
<!-- A -->
<use xlink:href='#a' x='150' y='30' >
<animate attributeName='x' from='150' to='150' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='y' id='a01' from='30' to='135' begin='start.begin' dur='2' fill='freeze' />
<animate attributeName='y' id='a03' from='135' to='220' begin='xor01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='a04' from='220' to='300' begin='m01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='a06y' from='300' to='400' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='x' id='a06x' from='150' to='250' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='y' id='a07' from='400' to='30' begin='a06y.end+2' dur='5' fill='freeze' />


</use>
<!-- B -->
<use xlink:href='#b' x='250' y='30' >
<animate attributeName='x' from='250' to='250' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='y' id='b01' from='30' to='100' begin='start.begin' dur='2' fill='freeze' />
<animate attributeName='y' id='b03' from='100' to='220' begin='xor01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='b04' from='220' to='300' begin='m01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='b06y' from='300' to='400' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='x' id='b06x' from='250' to='350' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='y' id='b07' from='400' to='30' begin='b06y.end+2' dur='5' fill='freeze' />


</use>
<use xlink:href='#b' x='-150' y='100' >
<set attributeName='x' to='250' begin='b01.end' />
<set attributeName='y' to='100' begin='b01.end' />
<animate attributeName='x' id='b02' from='250' to='195' begin='b01.end+4' dur='1' fill='freeze' />
<set attributeName='x' to='-150' begin='b02.end' />
<animate attributeName='x' from='-150' to='-150' begin='b02.end' dur='0' fill='freeze' />
<set attributeName='y' to='300' begin='k01.end+3' />
<animate attributeName='x' id='b05' from='250' to='150' begin='k01.end+3' dur='2' fill='freeze' />
<set attributeName='x' to='-150' begin='b05.end' />
<animate attributeName='x' from='-150' to='-150' begin='b05.end' dur='0' fill='freeze' />
</use>
<!-- C -->
<use xlink:href='#c' x='350' y='30' >
<animate attributeName='x' from='350' to='350' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='y' id='c01' from='30' to='135' begin='start.begin' dur='2' fill='freeze' />
<animate attributeName='y' id='c03' from='135' to='220' begin='xor01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='c04' from='220' to='300' begin='m01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='c06y' from='300' to='400' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='x' id='c06x' from='350' to='450' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='y' id='c07' from='400' to='30' begin='c06y.end+2' dur='5' fill='freeze' />

</use>
<use xlink:href='#c' x='-250' y='135' >
<set attributeName='x' to='350' begin='c01.end'  />
<animate attributeName='x' id='c02' from='350' to='195' begin='c01.end+2' dur='3' fill='freeze' />
<set attributeName='x' to='-150' begin='c02.end' />
<animate attributeName='x' from='-150' to='-150' begin='c02.end' dur='0' fill='freeze' />
</use>
<use xlink:href='#bit' x='-150' y='135' >
<animate attributeName='x' id='xor01' from='200' to='150' begin='f_ani2.end' dur='2' fill='freeze' />
<set attributeName='x' to='-150' begin='f_ani2.end+2' />
<animate attributeName='x' from='-150' to='-150' begin='f_ani2.end+2' dur='0' fill='freeze' />
</use>


<!-- D -->
<use xlink:href='#d' x='450' y='30' >
<animate attributeName='x' from='450' to='450' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='y' id='d01' from='30' to='170' begin='start.begin' dur='2' fill='freeze' />
<animate attributeName='y' id='d03' from='170' to='220' begin='xor01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='d04' from='220' to='300' begin='m01.end+1' dur='2' fill='freeze' />
<animate attributeName='y' id='d06y' from='300' to='400' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='x' id='d06x' from='450' to='150' begin='b05.end+1' dur='3' fill='freeze' />
<animate attributeName='y' id='d07' from='400' to='30' begin='d06y.end+2' dur='5' fill='freeze' />


</use>
<use xlink:href='#d' x='-350' y='170' >
<set attributeName='x' to='450' begin='d01.end'  />
<animate attributeName='x' id='d02' from='450' to='195' begin='d01.end' dur='5' fill='freeze' />
<set attributeName='x' to='-150' begin='d02.end' />
<animate attributeName='x' from='-150' to='-150' begin='d02.end' dur='0' fill='freeze' />
</use>

<!-- add -->
<use xlink:href='#add' x='-350' y='135' >
<set attributeName='x' to='150' begin='xor01.end' />
<set attributeName='y' to='135' begin='xor01.end' />
<set attributeName='x' to='-150' begin='xor01.end+1' />
<set attributeName='y' to='220' begin='m01.end' />
<set attributeName='x' to='150' begin='m01.end' />
<set attributeName='x' to='-150' begin='m01.end+1' />
<set attributeName='x' to='150' begin='k01.end' />
<set attributeName='y' to='300' begin='k01.end' />
<set attributeName='x' to='-150' begin='k01.end+1' />
<set attributeName='x' to='150' begin='b05.end' />
<set attributeName='y' to='300' begin='b05.end' />
<set attributeName='x' to='-150' begin='b05.end+1' />
</use>

<use xlink:href='#shift' x='-150' y='300' >

<set attributeName='x' to='150' dur='1' begin='k01.end+2' />

</use>


<text fill='black' x='5' y='200' style="font-size:12px;">
16*32 bit of
</text>
<text fill='black' x='5' y='210' style="font-size:12px;">
message (512 bit)
</text>
<use xlink:href='#mn' x='5' y='220' />
<text fill='black' x='45' y='240'>
...
</text>
<use xlink:href='#m1' x='65' y='220' >
<animate attributeName='x' from='65' to='65' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='x' id='m02' from='65' to='85' begin='a07.end-1' dur='1' fill='freeze' />
</use>
<use xlink:href='#m0' x='85' y='220' >
<animate attributeName='x' from='85' to='85' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='x' id='m01' from='85' to='150' begin='a03.end' dur='1' fill='freeze' />
<set attributeName='x' to='-150' begin='m01.end' />
<animate attributeName='x' from='-150' to='-150' begin='m01.end' dur='0' fill='freeze' />
</use>

<text fill='black' x='5' y='280' style="font-size:12px;">
16*32 bit of
</text>
<text fill='black' x='5' y='290' style="font-size:12px;">
constant (512 bit)
</text>
<use xlink:href='#kn' x='5' y='300' />
<text fill='black' x='45' y='320'>
...
</text>
<use xlink:href='#k1' x='65' y='300' >
<animate attributeName='x' from='65' to='65' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='x' id='k02' from='65' to='85' begin='a07.end-1' dur='1' fill='freeze' />
</use>
<use xlink:href='#k0' x='85' y='300' >
<animate attributeName='x' from='85' to='85' begin='start.begin' dur='0' fill='freeze' />
<animate attributeName='x' id='k01' from='85' to='150' begin='a04.end' dur='1' fill='freeze' />
<set attributeName='x' to='-150' begin='k01.end' />
<animate attributeName='x' from='-150' to='-150' begin='k01.end' dur='0' fill='freeze' />
</use>

<text fill='black' x='300' y='15'  style="font-size:18px;" >
Old state
</text>
<text fill='black' x='220' y='460' opacity='0' style="font-size:18px;" >
<set attributeName='opacity' to='1' begin='a06x.end' />
<set attributeName='opacity' to='0' begin='a06x.end+4' />
New state for next round
</text>
<text fill='black' x='210' y='190' opacity='0' style="font-size:38px;" >
<set attributeName='opacity' to='0' begin='start.begin' />
<set attributeName='opacity' to='1' begin='a07.end' />
New round
</text>
<use xlink:href='#bit' x='550' y='50' />
<text fill='black' x='645' y='70' style="font-size:14px;" >
= 32 bit value
</text>
<use xlink:href='#a' x='550' y='100' />
<use xlink:href='#b' x='570' y='100' />
<use xlink:href='#c' x='590' y='100' />
<use xlink:href='#d' x='610' y='100' />

<text fill='black' x='645' y='120' style="font-size:14px;" >
= MD5 state / hash value
</text>
<text fill='black' x='685' y='140' style="font-size:14px;" >
(128 bit)
</text>
<!--
<use xlink:href='#m' x='550' y='150' />
<text fill='black' x='580' y='170'>
...
</text>
<use xlink:href='#m' x='590' y='150' />
<use xlink:href='#m' x='610' y='150' />
<text fill='black' x='645' y='170' style="font-size:14px;" >
= 512 bit message block
</text>

<use xlink:href='#k' x='550' y='200' />
<text fill='black' x='580' y='220'>
...
</text>
<use xlink:href='#k' x='590' y='200' />
<use xlink:href='#k' x='610' y='200' />
<text fill='black' x='645' y='220' style="font-size:14px;" >
= 512 bit constant block
</text>-->

<rect x='550' y='250' width="20" height="100" rx="10" ry="10"
      fill="white" stroke="black" />
<text fill='black' x='645' y='300' style="font-size:14px;" >
= Functions F, G, H, I
</text>       
<path d='M 525 5 l 0 450' stroke='black' stroke-dasharray="10,10" />

<use xlink:href='#add' x='550' y='150' />
<text fill='black' x='645' y='170' style="font-size:14px;" >
= modulo 2^32 addition
</text>

<use xlink:href='#shift' x='550' y='200' />
<text fill='black' x='645' y='220' style="font-size:14px;" >
= Leftshift
</text>


<svg x='0' y='0' width='1' height='1' >
<set attributeName='x' from='0' to='0' dur='1' id='start' begin='round1.click;round2.click;round3.click;round4.click' />
</svg>

<svg height='25' width='100' x='5' y='425' id='round1' >
<set attributeName='opacity' to='0' begin='start.begin' />
<set attributeName='opacity' to='1' begin='a07.end' />
<rect height='24' width='99' x='0.5' y='0.5' rx='5' ry='5' stroke='black' fill='white' />
 <text fill='black' x='5' y='18' style="font-size:14px;" >
Round 0-15
</text>
</svg>

<svg height='25' width='100' x='115' y='425' id='round2' >
<set attributeName='opacity' to='0' begin='start.begin' />
<set attributeName='opacity' to='1' begin='a07.end' />
<rect height='24' width='99' x='0.5' y='0.5' rx='5' ry='5' stroke='black' fill='white' />
 <text fill='black' x='5' y='18' style="font-size:14px;" >
Round 16-31
</text>
</svg>

<svg height='25' width='100' x='225' y='425' id='round3' >
<set attributeName='opacity' to='0' begin='start.begin' />
<set attributeName='opacity' to='1' begin='a07.end' />
<rect height='24' width='99' x='0.5' y='0.5' rx='5' ry='5' stroke='black' fill='white' />
 <text fill='black' x='5' y='18' style="font-size:14px;" >
Round 32-47
</text>
</svg>

<svg height='25' width='100' x='335' y='425' id='round4' >
<set attributeName='opacity' to='0' begin='start.begin' />
<set attributeName='opacity' to='1' begin='a07.end' />
<rect height='24' width='99' x='0.5' y='0.5' rx='5' ry='5' stroke='black' fill='white' />
 <text fill='black' x='5' y='18' style="font-size:14px;" >
Round 48-63
</text>
</svg>


</g>
</svg>
