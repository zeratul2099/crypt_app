<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   width="650"
   height="450"
   id="svg2"
>
<script type="text/ecmascript" xlink:href="/content/smil.user.js" />
  <defs
     id="defs4">
       <svg width="30" height="30" id="bit48"  >
            <rect y="10" x="0.1" width="19.9" height="19.9" fill="white" stroke="black" />
            <polygon fill="white" stroke="black" 
                points="0.1 10, 10 0.1, 29.9 0.1, 20 10" />
            <polygon fill="white" stroke="black" 
                points="29.9 0.1, 29.9 20, 20 29.9, 20 10" />
            
       </svg>
       <svg width='27' height='27' id='bit32' >
       <use xlink:href='#bit48' transform="scale(0.85)" />
       </svg>
       <svg width='45' height='45' id='bit64' >
       <use xlink:href='#bit48' transform="scale(1.3)" />
       </svg>
       <svg width='15' height='15' id='bit6' >
       <use xlink:href='#bit48' transform="scale(0.5)" />
       </svg>
       <svg width='12' height='12' id='bit4' >
       <use xlink:href='#bit48' transform="scale(0.35)" />
       </svg>


  </defs>

    <g
       
       style="fill:none;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:round;stroke-opacity:1;font-family:'sans';"
       id="g2383 " transform="scale(1)"
       >
<rect x='0' y='0' width='800' height='600' fill='white' />
<!-- E -->
<svg x='185' y='140' width='75' height='20' >
<rect width='73' height='19' x='1' y='0.5' rx='15' ry='15' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='r02.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='r02.end+1' fill='freeze' />
</rect>
<text x='35' y='16' font-size='14' fill='black' >
E
</text>
</svg>
<!-- P -->
<svg x='185' y='350' width='75' height='20' >
<rect width='73' height='19' x='1' y='0.5' rx='15' ry='15' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s03.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s03.end+1' fill='freeze' />
</rect>
<text x='35' y='16' font-size='14' fill='black' >
P
</text>
</svg>


<use xlink:href='#bit64' x='150' y='50' >
<animate attributeName='opacity' from='1' to='0' begin='start.click' dur='1' fill='freeze' />
<animate attributeName='opacity' from='0' to='1' begin='r06.end+5' dur='1' fill='freeze' />
</use>
<text x='130' y='40' font-size='14' fill='black' >
message block m
<animate attributeName='opacity' from='1' to='1' begin='start.click' dur='0' fill='freeze' />
<animate attributeName='opacity' from='0' to='0' begin='r01.end' dur='0' fill='freeze' />
</text>
<!-- l -->
<svg width="27" height="27" x='155' y='58' opacity='0' >
<use xlink:href='#bit32' />
<text x='5' y='23' font-size='14' fill='black' >
l
</text>
<animate attributeName='opacity' from='0' to='1' begin='start.click' dur='1' fill='freeze' />
<animate attributeName='x' from='155' to='100' begin='start.click' dur='2' fill='freeze' />
<animate attributeName='y' from='58' to='80' begin='start.click' dur='2' fill='freeze' />
<animate attributeName='x' from='100' to='20' begin='s04.end+1' dur='1' fill='freeze' id='l01' />
<animate attributeName='y' from='80' to='400' begin='l01.end' dur='4' fill='freeze' id='l02' />
<animate attributeName='x' from='20' to='205' begin='l02.end' dur='2' fill='freeze' id='l03' />
<animate attributeName='opacity' from='0' to='0' begin='l03.end' dur='0' fill='freeze' />
</svg>

<!-- r  -->
<svg width="27" height="27" x='210' y='80' opacity='0' >
<use xlink:href='#bit32' />
<text x='5' y='23' font-size='14' fill='black' >
r
<set attributeName='opacity' to='1' dur='0' fill='freeze' begin='start.click' />
<set attributeName='opacity' to='0' dur='0' fill='freeze' begin='r06.end' />
</text>
<text x='5' y='23' font-size='14' fill='black' opacity='0' >
l
<set attributeName='opacity' to='0' dur='0' fill='freeze' begin='start.click' />
<set attributeName='opacity' to='1' dur='0' fill='freeze' begin='r06.end' />
</text>
<animate attributeName='x' from='210' to='210' dur='0' begin='start.click' fill='freeze' />
<animate attributeName='y' from='80' to='80' dur='0' begin='start.click' fill='freeze' />
<animate attributeName='opacity' from='1' to='1' begin='r01.end' dur='0' fill='freeze' />
<animate attributeName='x' from='210' to='100' dur='2' begin='r05.end' fill='freeze' />
<animate attributeName='x' from='100' to='155' dur='2' begin='r06.end+4' fill='freeze' />
<animate attributeName='y' from='80' to='58' dur='2' begin='r06.end+4' fill='freeze' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='r06.end+5'/>
</svg>

<svg width="27" height="27" x='155' y='58' opacity='0' >
<use xlink:href='#bit32' />
<text x='5' y='23' font-size='14' fill='black' >
r
</text>
<animate attributeName='opacity' from='0' to='1' begin='start.click' dur='1' fill='freeze' />
<animate attributeName='x' from='155' to='210' begin='start.click' dur='2' fill='freeze' />
<animate attributeName='y' from='58' to='80' begin='start.click' dur='2' fill='freeze' id='r01' />
<animate attributeName='y' from='80' to='140' begin='r01.end+1' dur='1' fill='freeze' id='r02' />
<animate attributeName='opacity' from='0' to='0' begin='r02.end' dur='0' fill='freeze' />
</svg>
<use xlink:href='#bit48' x='205' y='140' opacity='0' >
<animate attributeName='y' from='140' to='140' begin='start.click' dur='0' fill='freeze' />
<animate attributeName='opacity' from='1' to='1' begin='r02.end+2' dur='0' fill='freeze' />
<animate attributeName='y' from='140' to='180' begin='r02.end+2' dur='1' fill='freeze' id='r03' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='k01.end+2'/>
</use>

<!-- k -->
<svg width="30" height="30" x='300' y='180' opacity='1' >
<use xlink:href='#bit48' />
<text x='5' y='23' font-size='14' fill='black' >
k<tspan baseline-shift = "sub" font-size='8' >i</tspan>
</text>
<animate attributeName='opacity' from='1' to='1' begin='start.click' dur='0' fill='freeze' />
<animate attributeName='x' from='300' to='205' begin='r03.end' dur='2' id='k01' />
<animate attributeName='opacity' from='0' to='0' begin='k01.end' dur='0' fill='freeze' />
</svg>

<!-- XOR -->
<svg x='205' y='180' height='30' width='30' opacity='0' >
       <set attributeName='opacity' to='1' dur='1' begin='k01.end' />
       <circle cx='10' cy='20' r='8' stroke='red' stroke-width='2' />
       <path d="M 10 12 l 0 16 M 2 20 l 16 0" stroke='red' stroke-width='2' />
</svg>
<!-- s-boxes -->
<svg x='70' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >1</tspan>
</text>

</svg>

<svg x='110' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >2</tspan>
</text>
</svg>

<svg x='150' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >3</tspan>
</text>
</svg>

<svg x='190' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >4</tspan>
</text>
</svg>

<svg x='230' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >5</tspan>
</text>
</svg>

<svg x='270' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >6</tspan>
</text>
</svg>

<svg x='310' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >7</tspan>
</text>
</svg>

<svg x='350' y='250' width='30' height='30' >
<circle cx='15' cy='15' r='14' stroke='black' fill='white' >
<animate attributeName='fill' from='white' to='red' dur='1' begin='s01.end' fill='freeze' />
<animate attributeName='fill' from='red' to='white' dur='1' begin='s01.end+1' fill='freeze' />
</circle>
<text x='10' y='20' font-size='14' fill='black' >
s<tspan baseline-shift = "sub" font-size='8' >8</tspan>
</text>
</svg>
<!-- b -->
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='75' dur='2' begin='k01.end+2' id='s01' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='115' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='155' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='195' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='235' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='275' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='315' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<use xlink:href='#bit6' x='210' y='190' opacity='0' >
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='k01.end+2'/>
<animate attributeName='x' from='210' to='355' dur='2' begin='k01.end+2' />
<animate attributeName='y' from='190' to='255' dur='2' begin='k01.end+2' />
<animate attributeName='opacity' from='0' to='0' dur='0' fill='freeze' begin='s01.end' />
</use>
<!-- b' -->
<use xlink:href='#bit4' x='80' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='80' to='210' dur='2' begin='s01.end+2' id='s02' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='120' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='120' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='160' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='160' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='200' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='200' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='240' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='240' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='280' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='280' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='320' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='320' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<use xlink:href='#bit4' x='360' y='260' opacity='0' >
<animate attributeName='opacity' from='1' to='1' dur='0' fill='freeze' begin='s01.end+2'/>
<animate attributeName='x' from='360' to='210' dur='2' begin='s01.end+2' />
<animate attributeName='y' from='260' to='320' dur='2' begin='s01.end+2' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='s01.end+3'/>
</use>
<svg height='30' width='30' x='205' y='315' opacity='0' >
<use xlink:href='#bit32' />
<text x='5' y='23' font-size='14' fill='black' opacity='0' >
r
<set attributeName='opacity' to='0' dur='0' fill='freeze' begin='start.click' />
<set attributeName='opacity' to='1' dur='0' fill='freeze' begin='r06.end' />
</text>
<animate attributeName='x' from='205' to='205' dur='0' begin='start.click' fill='freeze' />
<animate attributeName='y' from='315' to='315' dur='0' begin='start.click' fill='freeze' />
<animate attributeName='opacity' from='0' to='1' dur='1' fill='freeze' begin='s01.end+3'/>
<animate attributeName='y' from='315' to='350' dur='1' begin='s02.end+1' fill='freeze' id='s03' />
<animate attributeName='opacity' from='0' to='0' dur='1' begin='s03.end' fill='freeze' />
<animate attributeName='opacity' from='1' to='1' dur='1' begin='s03.end+2' fill='freeze' />
<animate attributeName='y' from='350' to='400' dur='1' begin='s03.end+2' fill='freeze' id='s04' />
<animate attributeName='x' from='205' to='400' dur='2' begin='l03.end+2' fill='freeze' id='r04' />
<animate attributeName='y' from='400' to='80' dur='4' begin='r04.end' fill='freeze' id='r05' />
<animate attributeName='x' from='400' to='210' dur='2' begin='r05.end' fill='freeze' id='r06' />
<animate attributeName='y' from='80' to='58' dur='2' begin='r06.end+4' fill='freeze' />
<animate attributeName='x' from='210' to='155' dur='2' begin='r06.end+4' fill='freeze' id='r07' />
<animate attributeName='opacity' from='1' to='0' dur='1' fill='freeze' begin='r06.end+5'/>
</svg>
<!-- XOR  2 -->
<svg x='205' y='400' height='30' width='30' opacity='0'  >
       <set attributeName='opacity' to='1' dur='1' begin='l03.end' />
       <circle cx='10' cy='20' r='8' stroke='red' stroke-width='2' transform='scale(0.85)'/>
       <path d="M 10 12 l 0 16 M 2 20 l 16 0" stroke='red' stroke-width='2' transform='scale(0.85)'/>
</svg>
<text x='130' y='220' font-size='28' fill='black' opacity='0' >
repeat 16 rounds
<set attributeName='opacity' to='1' dur='3' begin='r06.end' />
</text>
<!-- Legend -->
<path d='M 450 0 l 0 430' stroke='black' stroke-dasharray='5, 5' />
<svg height='40' width='150' x='460' y='10' >
<use xlink:href='#bit64' />
<text x='45' y='20' font-size='14' fill='black'  >
= 64 bit block
</text>
</svg>
<svg height='40' width='150' x='460' y='60' >
<use xlink:href='#bit48' />
<text x='45' y='20' font-size='14' fill='black'  >
= 48 bit block
</text>
</svg>
<svg height='40' width='150' x='460' y='100' >
<use xlink:href='#bit32' />
<text x='45' y='20' font-size='14' fill='black'  >
= 32 bit block
</text>
</svg>
<svg height='40' width='150' x='460' y='135' >
<use xlink:href='#bit6' />
<text x='45' y='15' font-size='14' fill='black'  >
= 6 bit block
</text>
</svg>
<svg height='40' width='150' x='460' y='155' >
<use xlink:href='#bit4' y='5' />
<text x='45' y='15' font-size='14' fill='black'  >
= 4 bit block
</text>
</svg>
<svg height='40' width='150' x='460' y='200' >
<text x='0' y='20' font-size='14' fill='black'  >
E = 
</text>
<text x='28' y='12' font-size='14' fill='black'  >
Expansion
</text>
<text x='28' y='28' font-size='14' fill='black'  >
32 -&gt; 48 bit
</text>
</svg>
<svg height='40' width='150' x='460' y='230' >
<text x='0' y='20' font-size='14' fill='black'  >
s = s-box 
</text>
</svg>
<svg height='40' width='150' x='460' y='260' >
<text x='0' y='20' font-size='14' fill='black'  >
P = Permutation 
</text>
</svg>
<svg height='25' width='75' x='460' y='300' id='start' >
<set attributeName='x' to='-100' begin='start.click' />
<set attributeName='x' to='460' begin='r07.end' />
<rect height='24' width='74' x='0.5' y='0.5' rx='5' ry='5' stroke='black' fill='white' />
 <text fill='black' x='25' y='18' style="font-size:14px;" >
Start
</text>
</svg>
</g>
</svg>
